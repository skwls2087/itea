<?xml version="1.0" encoding="UTF-8"  ?>
<!-- xml선언부-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ask">
	
	<!-- 페이징 처리 -->
	<select id="getTotalCnt" resultType="int">
		select count(*) from askboard
	</select>
	
	<!-- 게시판 목록 -->
	<select id="list" resultType="askDTO">
		SELECT ano,atitle,j.pno,l.lname,adate,ahit FROM
		(SELECT askboard.pno,ano, lno,atitle, adate, ahit FROM 
		askboard JOIN problem ON askboard.pno=problem.pno
		order by ano) j
		JOIN license l ON j.lno=l.lno
		ORDER BY ano desc
		LIMIT #{start}, #{size}
		
	</select>
	
	<!-- 게시글 입력 -->
	<insert id="aWriteProc">
		insert into askboard(pno,anick,atitle,acontent)
		values(#{pno},#{anick},#{atitle},#{acontent})
	</insert>
	
	<!-- 상세보기 -->
	<select id="askDetail" resultType="askDTO">
		select ano,atitle,a.pno,l.lname,anick,acontent
		from askboard a ,problem p ,license l
		where a.pno=p.pno and l.lno=p.lno and a.ano=#{ano}
	</select>
	
	<!-- 게시글 수정 -->
	<update id="askModifyProc">
		update askboard
		set atitle=#{atitle},
			acontent=#{acontent},
			pno=#{pno}
		where ano=#{ano}
	</update>
	
	<!-- 게시글 삭제 -->
	<delete id="askDelete">
		delete from askboard
		where ano=#{ano}
	</delete>
	
	<!-- 조회수 증가 -->
	<update id="askCnt">
		update askboard
		set ahit=ahit+1
		where ano=#{ano}
	</update>
	
	
</mapper>
	