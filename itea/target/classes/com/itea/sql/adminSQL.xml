<?xml version="1.0" encoding="UTF-8"  ?>
<!-- xml선언부-->

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<!-- myBatis-config.xml의     mapper로 반드시 등록되어야 한다 --> 
<mapper namespace="admin">

	<!-- 회원리스트 조예인-->
	<select id="listPage" resultType="memberDTO">
		select mnick,mmail,mclass,mname,mphone,mdate
		from member
		where mno>0
		<include refid="searchCondition"></include>
		order by mno desc
		limit #{pageStart},#{perPageNum}
	</select>
	
	<!-- 전체게시물 수 조회-->
	<select id="totalCnt" resultType="int">
		select  count(*) 
		from 		member
		where bno>0
		<include refid="searchCondition"></include>
	</select> 
	
	<sql id="searchCondition">
	<!-- 검색 조건이 null이 아니라면 검색조건에 따른 데이터 조회-->
		<if test="searchType != null">
			<if test="searchType == 'mnick'.toString()">
				and mnick like CONCAT('%', #{keyword}, '%')
			</if>
			<if test="searchType == 'mmail'.toString()">
				and mmail like CONCAT('%', #{keyword}, '%')
			</if>
		</if>
	</sql>
	

</mapper>














